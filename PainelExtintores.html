<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Painel de Controle de Extintores</title>

  <!-- Tailwind (Play CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Pequenos ajustes para o layout */
    .shadow-t-lg { box-shadow: 0 -6px 18px rgba(0,0,0,0.06); }
    /* Corrigindo a rota√ß√£o do texto central do gr√°fico de rosca */
    .shadow-inner { filter: drop-shadow(0 1px 1px rgba(0,0,0,0.04)); }
    /* For√ßar que selects e inputs tenham boa apar√™ncia em browsers */
    select, input[type="text"], input[type="number"], input[type="password"] { appearance: none; -webkit-appearance: none; }
    /* Modal scroll */
    .modal-scroll { max-height: 70vh; overflow-y: auto; }
    
    /* Regras de largura espec√≠ficas */
    .w-fit-content { width: fit-content; }
    .min-w-200 { min-width: 200px; }

      body {
        margin-top: 4.5rem !important;
      }
      .fixed {
        margin-top: 4.5rem;
      }
      .bg-white.rounded-xl.shadow-2xl.p-6.transform.transition-all.w-full.max-w-2xl {
        top: 1rem;
        position: absolute;
        width: 90%;
      }
      
    /* Cores Gr√°fico */
        #main-content svg > path:nth-child(1)  { color: #29bc01; }
        #main-content svg > path:nth-child(2)  { color: #dc2626; }
        #main-content svg > path:nth-child(3)  { color: #dc9526; }
        #main-content svg > path:nth-child(4)  { color: #dccc26; }
        #main-content svg > path:nth-child(5)  { color: #b5dc26; }
        #main-content svg > path:nth-child(6)  { color: #26dc98; }
        #main-content svg > path:nth-child(7)  { color: #26d1dc; }
        #main-content svg > path:nth-child(8)  { color: #2663dc; }
        #main-content svg > path:nth-child(9)  { color: #7626dc; }
        #main-content svg > path:nth-child(10) { color: #ad26dc; }
        #main-content svg > path:nth-child(11) { color: #dc26ce; }
        #main-content svg > path:nth-child(12) { color: #dc2672; }
        #main-content svg > path:nth-child(13) { color: #7f7f7f; }
        #main-content svg > path:nth-child(14) { color: #525252; }
        #main-content svg > path:nth-child(15) { color: #333333; }

    @media (max-width: 768px) {
      #tabs {
        margin-bottom: 1rem;
      }
      .space-y-8.bg-white.p-6.rounded-xl.shadow-lg section .p-4.border.rounded-lg.bg-gray-50.space-y-4 .flex.space-x-2 {
        display: flex;
        flex-direction: row;
        align-items: stretch;
        flex-wrap: wrap;
      }
      .space-y-8.bg-white.p-6.rounded-xl.shadow-lg section .p-4.border.rounded-lg.bg-gray-50.space-y-4 .flex.space-x-2 input#data-range-input {
        margin-bottom: 1rem;
      }

      .text-xl {
        font-size: 1.1rem !important;
      }
      .text-2xl {
        font-size: 1.3rem;
      }
    }

    /* CABE√áALHO */
      header.cabecalho {
        display: flex;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 9999999;
        background: #222222;
        width: 100vw;
        height: 4.5rem;
        flex-direction: row;
        justify-content: center;
        color: rgb(255 255 255 / 95%);
        align-items: center;
      }
      header.cabecalho > a {
        display: flex;
      }
      img.logoSCI {
        width: 3.2em;
        height: 3.2em;
        background: url(data:image/png;base64,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);
        background-size: cover;
        border-radius: 10em;
        margin-right: 0.6rem;
      }
      h1.titulo {
        font-size: 1.1rem;
        font-weight: 700;
        line-height: normal;
      }
      .sub-titulo {
        font-size: 1.2rem;
        font-weight: 500;
        color: rgb(255 255 255 / 95%);
        line-height: normal;
      }

    /* DASHBOARD */
    .space-y-8 {
      display: grid;
      grid-template-columns: 1fr 1fr;
    }
    .grid.grid-cols-1.sm\:grid-cols-2.lg\:grid-cols-4.gap-4 {
      grid-column: 1 / 3;
    }
    .painel-grafico, #non-conformity-list {
      width: 98%;
      overflow: auto;
      margin-left: 1%;
    }
    @media (max-width: 768px) { .painel-grafico {
      height: fit-content;
    }
    .painel-grafico .space-y-2.max-h-48 {
      max-height: none;
    }
                              
                              }
    @media (max-width: 1024px) {
    .painel-grafico, #non-conformity-list {
      grid-column: 1 / 3;
    }
    .painel-grafico .max-h-48 {
      max-height: none;
    }
                               }

    /* CONFIGURA√á√ïES */
    .space-y-8.bg-white.p-6.rounded-xl.shadow-lg {
      grid-template-columns: none;
    }

    /* CONTAINER IFRAME */
    .div-inspecoes {
      width: 100%;
      max-width: none !important;
      margin: 0;
      box-shadow: none;
      border: none;
    }
    .info-nomeUsuario {
      display: none;
    }
  </style>
</head>
<body class="min-h-screen bg-gray-100 font-sans p-4 md:p-8">

<!-- Header -->
<header class="cabecalho">
  <a href="./">
    <img class="logoSCI"></img>
    <div class="titulo-superior">
      <h1 class="titulo">Painel de Controle de Extintores</h1>
      <p class="sub-titulo">SCI AEROPORTO DE JOIVILLE</p>
    </div>
  </a>
</header>

<!-- Tabs -->
<!-- Classe modificada para justify-between -->
<div class="tabs-conteiner"></div>
<div id="tabs" class="flex justify-between border-b border-gray-300 mb-6 sticky top-0 bg-gray-100 z-20">
    <!-- Buttons gerados por JS -->
</div>

<main id="main-content" class="pb-8"></main>

<!-- Modal container -->
<div id="modal-root"></div>

<!-- Template: Loading -->
<template id="loading-template">
  <div class="flex items-center justify-center h-64 text-red-500">
    <div class="animate-spin mr-3">üîÑ</div>
    <span class="text-lg font-semibold">Carregando dados da planilha...</span>
  </div>
</template>

<script>

  function isMobile() {
  return window.innerWidth < 768; // md breakpoint
}

/* ============================================
   Convers√£o do index.jsx para JS "vanilla"
   Mantive as mesmas vari√°veis e l√≥gica
   ============================================ */

/* --------- CONFIGURA√á√ïES (origem do sheet) --------- */
const SHEET_ID = '1RKNORO-bzM83ixu09xFVFboXLjwaOsCzWcZwKMLTTXM';
const GID = '2123598553';
const DEFAULT_RANGE = 'A:O';
const GOOGLE_SHEET_BASE_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&gid=${GID}&range=`;

/* ----- CONFIG INICIAL (colunas, pain√©is) ----- */
const INITIAL_COLUMNS_CONFIG = [
  { key: 'N¬∫', label: 'N¬∫', visible: true, isId: true, isFixed: true },
  { key: 'Local', label: 'Local', visible: true, isChartSource: true },
  { key: 'Descri√ß√£o', label: 'Descri√ß√£o', visible: true },
  { key: 'Tipo Kg', label: 'Tipo/Kg', visible: true, isChartSource: true },
  { key: 'MESMO TIPO DA PLANTA?', label: 'Mesmo Tipo?', visible: true, isChartSource: false },
  { key: 'SUBSTITUTO', label: 'Substituto', visible: true },
  { key: 'Kg', label: 'Kg', visible: true },
  { key: 'SITUA√á√ÉO', label: 'Situa√ß√£o', visible: true, isStatus: true, isChartSource: true },
  { key: 'N√£o conformidade', label: 'N√£o conformidade', visible: true },
  { key: 'Observa√ß√£o', label: 'Observa√ß√£o', visible: true },
  { key: '2¬∫ N√≠vel', label: '2¬∫ N√≠vel', visible: true, isDate: true, dateFormat: 'MM/YY' },
  { key: '3¬∫ N√≠vel', label: '3¬∫ N√≠vel', visible: true, isDate: true, dateFormat: 'YYYY' },
  { key: 'Equipe', label: 'Equipe', visible: true, isChartSource: true },
  { key: 'Respons√°vel', label: 'Respons√°vel', visible: true, isChartSource: true },
  { key: 'DATA/HORA', label: 'Data/Hora', visible: true },
];

const PANEL_BLOCKS_STRUCTURE = [
  { name: 'Identifica√ß√£o', fields: ['N¬∫', 'Local', 'Descri√ß√£o'] },
  { name: 'Tipo e Peso', fields: ['Tipo Kg', 'Kg', 'MESMO TIPO DA PLANTA?'] },
  { name: 'Situa√ß√£o', fields: ['SITUA√á√ÉO', 'N√£o conformidade', 'Observa√ß√£o'] },
  { name: 'Datas de Inspe√ß√£o', fields: ['2¬∫ N√≠vel', '3¬∫ N√≠vel'] },
  { name: 'Responsabilidade', fields: ['Equipe', 'Respons√°vel', 'DATA/HORA'] },
];

/* ---------- helpers de datas e status (copiados da l√≥gica) ---------- */
function parseDateMMYY(dateStr) {
  if (!dateStr || typeof dateStr !== 'string') return null;
  if (dateStr === '-' || dateStr.length !== 5) return null;
  const parts = dateStr.split('/');
  if (parts.length !== 2) return null;
  const month = parseInt(parts[0], 10);
  const year = 2000 + parseInt(parts[1], 10);
  if (isNaN(month) || isNaN(year)) return null;
  // Subtrair 1 do m√™s para ser 0-based
  return new Date(year, month - 1, 1); 
}
function parseDateYYYY(yearStr) {
  const year = parseInt(yearStr, 10);
  if (isNaN(year) || year < 1900) return null;
  return new Date(year, 11, 31);
}
function getDateStatus(key, value) {
  if (value === '-' || !value) return { color: 'text-gray-500', bgColor: 'bg-gray-100', status: 'Indefinido' };
  const now = new Date(); now.setHours(0,0,0,0);
  let expireDate = null;
  if (key === '2¬∫ N√≠vel') {
    expireDate = parseDateMMYY(String(value));
    if (!expireDate) return { color: 'text-gray-500', bgColor: 'bg-gray-100', status: 'Inv√°lido' };
    
    // Ajuste para considerar o √∫ltimo dia do m√™s para compara√ß√£o precisa
    const lastDayOfMonth = new Date(expireDate.getFullYear(), expireDate.getMonth() + 1, 0);

    if (lastDayOfMonth < now) return { color: 'text-red-600', bgColor: 'bg-red-200/50', status: 'Vencido' };
    const threeMonthsAhead = new Date(now); threeMonthsAhead.setMonth(now.getMonth() + 3);
    if (lastDayOfMonth <= threeMonthsAhead) return { color: 'text-yellow-600', bgColor: 'bg-yellow-200/50', status: 'Pr√≥ximo do Vencimento' };
    return { color: 'text-green-600', bgColor: 'bg-green-200/50', status: 'V√°lido' };
  } else if (key === '3¬∫ N√≠vel') {
    const year = parseInt(value, 10);
    if (isNaN(year)) return { color: 'text-gray-500', bgColor: 'bg-gray-100', status: 'Inv√°lido' };
    if (year < now.getFullYear()) return { color: 'text-red-600', bgColor: 'bg-red-200/50', status: 'Vencido' };
    if (year === now.getFullYear()) {
      if (now.getMonth() >= 9) return { color: 'text-red-600', bgColor: 'bg-red-200/50', status: 'Vencido' };
      return { color: 'text-yellow-600', bgColor: 'bg-yellow-200/50', status: 'No Ano Vigente' };
    }
    return { color: 'text-green-600', bgColor: 'bg-green-200/50', status: 'V√°lido' };
  }
  return { color: 'text-gray-500', bgColor: 'bg-gray-100', status: 'Indefinido' };
}
function getStatusColor(value) {
  const normalized = String(value || '').toUpperCase().trim();
  if (normalized === 'CONFORME') return { color: 'text-green-600', bgColor: 'bg-green-200/50' };
  if (normalized === 'N√ÉO CONFORME' || normalized === 'NAO CONFORME') return { color: 'text-red-600', bgColor: 'bg-red-200/50' };
  if (normalized === '-') return { color: 'text-blue-600', bgColor: 'bg-blue-200/50' };
  return { color: 'text-gray-600', bgColor: 'bg-gray-200/50' };
}

/* ---------------- fetch + parse do Google Sheets (gviz) ---------------- */
async function fetchData(sheetUrl) {
  try {
    const res = await fetch(sheetUrl);
    const text = await res.text();
    // remover prefix/sufix do gviz
    const jsonText = text.substring(47, text.length - 2).trim();
    const data = JSON.parse(jsonText);
    if (!data.table || !data.table.rows) return [];
    const colLabels = data.table.cols.map(c => c.label).filter(Boolean);
    const parsed = data.table.rows.map((row, rowIndex) => {
      const ext = { id: rowIndex };
      row.c.forEach((cell, idx) => {
        const colLabel = colLabels[idx];
        if (!colLabel) return;
        let value = (cell && cell.v !== undefined) ? cell.v : '-';
        if (cell && cell.f !== undefined) value = cell.f;
        if (value === null || value === '') value = '-';
        if (value === 'null') value = '-'; // Ajuste para lidar com strings 'null'
        ext[colLabel] = String(value);
      });
      return ext;
    }).filter(e => e['N¬∫'] !== undefined && e['N¬∫'] !== '-' && e['N¬∫'] !== 'N¬∫');
    return parsed;
  } catch (err) {
    console.error('Erro ao buscar dados do Google Sheets:', err);
    return [];
  }
}

/* ----------------- Estado da "app" ----------------- */
const state = {
  data: [],
  loading: true,
  lastSyncTime: '',
  activeTab: 'Dashboard',
  filterText: 'Todas as Op√ß√µes',
  filterColumn: 'N¬∫',
  showModal: null,
  selectedExtinguisher: null,
  chartSourceKey: 'Equipe',
  syncIntervalMs: null, 
  config: {
    dataRange: DEFAULT_RANGE,
    allColumns: JSON.parse(JSON.stringify(INITIAL_COLUMNS_CONFIG)),
    tableStyle: { fontSize: 'text-xs', rowHeight: 'py-2', columnWidths: {} }
  },
  isLoggedIn: false,
  username: null,
  FIXED_PASSWORD: "extintor2024",
  // NOVO: Estado para controlar a visibilidade do filtro
  showFilter: false, 
};

/* ----------------- L√ìGICA DE AUTENTICA√á√ÉO SIMPLES ----------------- */
const LS_USERNAME_KEY = 'ext_app_username';
const LS_PASSWORD_KEY = 'ext_app_password'; 

function checkAuthOnLoad() {
  const storedUsername = localStorage.getItem(LS_USERNAME_KEY);
  const storedPassword = localStorage.getItem(LS_PASSWORD_KEY);
  
  if (storedUsername && storedPassword === state.FIXED_PASSWORD) {
    state.isLoggedIn = true;
    state.username = storedUsername;
  }
}

function handleLogin(e) {
  e.preventDefault();
  
  const form = e.target;
  const username = form.elements.username.value.trim();
  const password = form.elements.password.value;
  
  const errorMessageEl = document.getElementById('login-error-message');
  errorMessageEl.classList.add('hidden');

  if (!username || !password) {
    errorMessageEl.textContent = 'Por favor, preencha o nome e a senha.';
    errorMessageEl.classList.remove('hidden');
    return;
  }
  
  if (password === state.FIXED_PASSWORD) {
    state.isLoggedIn = true;
    state.username = username;
    
    localStorage.setItem(LS_USERNAME_KEY, username);
    localStorage.setItem(LS_PASSWORD_KEY, state.FIXED_PASSWORD);
    
    render();
  } else {
    errorMessageEl.textContent = 'Senha incorreta. Tente novamente.';
    errorMessageEl.classList.remove('hidden');
  }
}

function handleLogout() {
  state.isLoggedIn = false;
  state.username = null;
  localStorage.removeItem(LS_USERNAME_KEY); 
  localStorage.removeItem(LS_PASSWORD_KEY);

  render();
}

/* ---------- util DOM ---------- */
const $ = (sel) => document.querySelector(sel);
const $$ = (sel) => Array.from(document.querySelectorAll(sel));

/* ---------------- UI Rendering ---------------- */
function render() {
  renderTabs();
  renderMainContent();
  renderModal();
}

function renderTabs() {
  if (isMobile()) {
    return renderTabsMobile();
  } else {
    return renderTabsDesktop();
  }
}

function renderTabsDesktop() {
  const tabs = [
    { id: 'Dashboard', label: 'Dashboard', icon: 'üìä' },
    { id: 'Visualiza√ß√£o', label: 'Pain√©is', icon: '‚ñ¶' },
    { id: 'Tabela', label: 'Tabela', icon: 'üìã' },
    { id: 'Inspecoes', label: 'Inspe√ß√µes', icon: 'üìù' },
    { id: 'User', label: state.username ? `üë§ ${state.username}` : 'üë§ Usu√°rio', isRight: true },
    { id: 'Configura√ß√µes', label: '', icon: '‚öôÔ∏è', isRight: true },
  ];

  const container = $('#tabs');
  if (!container) return;

  container.className = "flex justify-between border-b border-gray-300 mb-6 sticky top-0 bg-gray-100 z-20";
  container.innerHTML = '';

  const leftNav = document.createElement('div');
  leftNav.className = 'flex';
  const rightNav = document.createElement('div');
  rightNav.className = 'flex';

  tabs.forEach(tab => {
    const btn = document.createElement('button');

    const isIconOnly = tab.id === 'Configura√ß√µes';
    const paddingClass = isIconOnly ? 'p-3' : 'px-4 py-3';

    btn.className = `
      flex items-center text-sm font-semibold transition-colors rounded-t-lg
      ${paddingClass}
      ${state.activeTab === tab.id
        ? 'border-b-4 border-red-600 text-red-600 bg-white'
        : 'text-gray-600 hover:text-red-500 hover:bg-gray-200'}
    `;

    btn.innerHTML = isIconOnly
      ? tab.icon
      : `<span class="mr-2">${tab.icon ?? ''}</span>${tab.label}`;

    btn.onclick = () => {
      state.activeTab = tab.id;
      state.showFilter = false;
      render();
    };

    if (tab.isRight) rightNav.appendChild(btn);
    else leftNav.appendChild(btn);
  });

  container.appendChild(leftNav);
  container.appendChild(rightNav);
}

function renderTabsMobile() {
  const tabs = [
    { id: 'Dashboard', label: 'Dashboard', icon: 'üìä' },
    { id: 'Visualiza√ß√£o', label: 'Pain√©is', icon: '‚ñ¶' },
    { id: 'Tabela', label: 'Tabela', icon: 'üìã' },
    { id: 'Inspecoes', label: 'Inspe√ß√µes', icon: 'üìù' },
    { id: 'User', label: state.username ? `üë§ ${state.username}` : 'üë§ Usu√°rio' },
    { id: 'Configura√ß√µes', label: 'Configura√ß√µes', icon: '‚öôÔ∏è' }, 
  ];

  const container = $('#tabs');
  container.className = "relative"; 
  container.innerHTML = '';

  // Bot√£o que abre o select
  const btnOpen = document.createElement("button");
  btnOpen.className = `
    w-full bg-white border border-gray-300 p-3 rounded-lg text-left 
    flex justify-between items-center
  `;
  btnOpen.innerHTML = `
    <span class="font-semibold">${state.activeTab}</span>
    <span>‚ñæ</span>
  `;
  container.appendChild(btnOpen);

  // Overlay
  const overlay = document.createElement("div");
  overlay.id = "mobile-menu-overlay";
  overlay.className = `
    fixed inset-0 bg-black bg-opacity-40 backdrop-blur-sm 
    flex items-start justify-center 
    transition-opacity duration-300 opacity-0 pointer-events-none z-50
  `;
  overlay.style.paddingTop = "7rem";
  document.body.appendChild(overlay);

  // Caixa das op√ß√µes
  const box = document.createElement("div");
  box.className = `
    bg-white shadow-xl rounded-xl w-11/12 p-4
    transform -translate-y-4 transition-all duration-300
  `;
  overlay.appendChild(box);

  // Op√ß√µes
  tabs.forEach(tab => {
    const opt = document.createElement("button");
    opt.className = `
      w-full text-left px-4 py-3 rounded-lg mb-2
      ${state.activeTab === tab.id ? 'bg-red-100 text-red-700' : 'bg-gray-100'}
    `;
    opt.innerHTML = `<span class="mr-2">${tab.icon ?? ''}</span>${tab.label}`;

    opt.onclick = () => {
      state.activeTab = tab.id;
      fecharMenu();
      setTimeout(render, 250);
    };

    box.appendChild(opt);
  });

  // Abrir menu
  btnOpen.onclick = () => {
    overlay.classList.remove("opacity-0", "pointer-events-none");
    overlay.classList.add("opacity-100");
  };

  // Fechar ao clicar fora
  overlay.addEventListener("click", (e) => {
    if (e.target === overlay) {
      fecharMenu();
    }
  });

  function fecharMenu() {
    overlay.classList.remove("opacity-100");
    overlay.classList.add("opacity-0", "pointer-events-none");

    setTimeout(() => {
      if (overlay.parentNode) overlay.remove();
    }, 300);
  }
}




/* ---------- FilterBar (reutiliz√°vel, agora recolh√≠vel e com click-outside) ---------- */
function createFilterBar() {
  const columns = state.config.allColumns;
  const uniqueValues = getUniqueValuesForFilter();
  
  // Wrapper principal com ID e classe 'relative'. REDUZIDO mt-4 para mt-2 e mb-4 para mb-2.
  const wrapper = document.createElement('div');
  wrapper.id = 'filter-wrapper';
  wrapper.className = "space-y-4 my-2 relative flex justify-end"; 
  
  // Bot√£o para mostrar/esconder o filtro. REDUZIDO py-2 para py-1.5 e aumentado px-4 para px-5.
  const toggleBtn = document.createElement('button');
  toggleBtn.id = 'filter-button';
  toggleBtn.className = "flex items-center text-sm font-semibold text-red-600 bg-white border border-gray-300 hover:bg-gray-50 transition duration-150 py-1.5 px-5 rounded-lg shadow-sm";
  toggleBtn.innerHTML = `Filtrar`;
  
  // Toggling state: Usa o estado global e renderiza
  toggleBtn.onclick = (e) => { 
      // √â crucial impedir a propaga√ß√£o para evitar que o listener do document feche o menu imediatamente
      e.stopPropagation(); 
      state.showFilter = !state.showFilter; 
      render(); 
  };
  wrapper.appendChild(toggleBtn);
  
  // Container do formul√°rio de filtro (agora flutuante)
  const filterFormContainer = document.createElement('div');
  filterFormContainer.id = 'filter-form-container';
  
  // Visibilidade controlada pelas classes de transi√ß√£o do Tailwind
  const isVisible = state.showFilter;
  filterFormContainer.className = `absolute z-30 w-full md:w-auto right-0 mt-2 
      transition-all duration-300 ease-in-out transform origin-top-right
      ${isVisible ? 'visible opacity-100 scale-100' : 'invisible opacity-0 scale-95'}`;

  // Conte√∫do do formul√°rio
  const formContent = document.createElement('div');
  formContent.className = "flex flex-col md:flex-row space-y-3 md:space-y-0 md:space-x-4 bg-white p-4 rounded-xl shadow-2xl border min-w-80";

  // select coluna
  const colDiv = document.createElement('div'); colDiv.className = "w-full md:w-56";
  colDiv.innerHTML = `<label class="text-xs text-gray-500 block mb-1">Filtrar Base</label>`;
  const selectCol = document.createElement('select');
  selectCol.className = "w-full p-2 border border-gray-300 rounded-lg bg-white";
  selectCol.value = state.filterColumn;
  selectCol.onchange = (e) => { 
    state.filterColumn = e.target.value; 
    state.filterText = 'Todas as Op√ß√µes'; 
    render(); 
  };
  columns.filter(c => c.visible).forEach(col => {
    const op = document.createElement('option'); op.value = col.key; op.textContent = col.label; selectCol.appendChild(op);
  });
  colDiv.appendChild(selectCol);
  formContent.appendChild(colDiv);

  // select valor
  const valDiv = document.createElement('div'); valDiv.className = "flex-grow";
  valDiv.innerHTML = `<label class="text-xs text-gray-500 block mb-1">Valor do Filtro</label>`;
  const selectVal = document.createElement('select');
  selectVal.className = "w-full p-2 border border-gray-300 rounded-lg bg-white focus:ring-red-500 focus:border-red-500";
  selectVal.onchange = (e) => { 
    state.filterText = e.target.value; 
    render(); 
  };
  uniqueValues.forEach(v => {
    const op = document.createElement('option'); op.value = v; op.textContent = (v === 'Todas as Op√ß√µes' ? 'Todas as Op√ß√µes' : (v === '-' ? '(Vazio/Indefinido)' : v)); selectVal.appendChild(op);
  });
  selectVal.value = state.filterText;
  valDiv.appendChild(selectVal);
  formContent.appendChild(valDiv);

  filterFormContainer.appendChild(formContent);
  wrapper.appendChild(filterFormContainer);

  return wrapper;
}

/* ---------- Computed data (filtros / KPIs) ---------- */
function getExtinguisherStatus(ext) {
  const situacao = String(ext['SITUA√á√ÉO'] || '').toUpperCase().trim();
  const isConforme = situacao === 'CONFORME';
  const isNaoConforme = situacao === 'N√ÉO CONFORME' || situacao === 'NAO CONFORME';
  let isAlert = false, alertDetails = [];
  if (!isConforme && !isNaoConforme) { isAlert = true; alertDetails.push('Situa√ß√£o Indefinida / N√£o Vistoriado'); }
  const s2 = getDateStatus('2¬∫ N√≠vel', ext['2¬∫ N√≠vel']);
  if (s2.status === 'Vencido' || s2.status === 'Pr√≥ximo do Vencimento') { isAlert = true; alertDetails.push(`2¬∫ N√≠vel: ${s2.status}`); }
  const s3 = getDateStatus('3¬∫ N√≠vel', ext['3¬∫ N√≠vel']);
  if (s3.status === 'Vencido' || s3.status === 'Pr√≥ximo do Vencimento') { isAlert = true; alertDetails.push(`3¬∫ N√≠vel: ${s3.status}`); }
  return { isConforme, isNaoConforme, isAlert, alertDetails };
}
function computeFiltered() {
  const data = state.data || [];
  let conf=0, naoConf=0, alerts=0;
  const naoConfList = [], alertsList = [];
  data.forEach(ext => {
    const s = getExtinguisherStatus(ext);
    if (s.isConforme) conf++;
    if (s.isNaoConforme) {
      naoConf++;
      naoConfList.push({ id: ext.id, num: ext['N¬∫'], situacao: ext['SITUA√á√ÉO'], naoConformidade: ext['N√£o conformidade'], observacao: ext['Observa√ß√£o'] });
    }
    if (s.isAlert) { alerts++; alertsList.push({ id: ext.id, num: ext['N¬∫'], local: ext['Local'], details: s.alertDetails }); }
  });

  const uniqueVals = ['Todas as Op√ß√µes'];
  if (data.length > 0) {
    const raw = Array.from(new Set(data.map(e => String(e[state.filterColumn] || '-'))));
    const unique = raw.filter(v => v !== 'Todas as Op√ß√µes').sort();
    uniqueVals.push(...unique);
  }

  const filtered = data.filter(ext => {
    if (!state.filterText || state.filterText === 'Todas as Op√ß√µes') return true;
    return String(ext[state.filterColumn] || '-') === String(state.filterText);
  });

  return { filteredData: filtered, conformingCount: conf, nonConformingCount: naoConf, alertCount: alerts, nonConformingList: naoConfList, activeAlertsList: alertsList, uniqueValuesForFilter: uniqueVals };
}
function getUniqueValuesForFilter() {
  const uniq = ['Todas as Op√ß√µes'];
  if (state.data.length > 0) {
    const raw = Array.from(new Set(state.data.map(e => String(e[state.filterColumn] || '-'))));
    const unique = raw.filter(v => v !== 'Todas as Op√ß√µes').sort();
    uniq.push(...unique);
  }
  return uniq;
}

/* ---------- Render dashboard (KPIs + doughnut + n√£o conformidades) ---------- */
function renderDashboardSection(container) {
  const { filteredData, conformingCount, nonConformingCount, alertCount, nonConformingList, activeAlertsList } = computeFiltered();

  // KPIs
  const kpiCards = [
    { title: 'Total de Extintores', count: state.data.length, color: 'text-blue-600', icon: 'üßØ', kpi: 'Total' },
    { title: 'Conformes', count: conformingCount, color: 'text-green-600', icon: '‚úÖ', kpi: 'Conformes' },
    { title: 'N√£o conformes', count: nonConformingCount, color: 'text-red-600', icon: '‚ùå', kpi: 'N√£o conformes' },
    { title: 'Alertas Ativos', count: alertCount, color: 'text-yellow-600', icon: '‚ö†Ô∏è', kpi: 'Alertas Ativos' },
  ];

  const kpiGrid = document.createElement('div'); kpiGrid.className = 'grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4';
  kpiCards.forEach(card => {
    const el = document.createElement('div');
    el.className = 'bg-white rounded-xl p-5 shadow-lg flex items-center justify-between cursor-pointer hover:shadow-xl transition-shadow border-t-2 border-gray-300';
    el.onclick = () => {
      if (card.kpi === 'Total') state.activeTab = 'Visualiza√ß√£o';
      else if (card.kpi === 'Conformes') { state.showModal = 'conforming'; render(); }
      else if (card.kpi === 'N√£o conformes') { state.activeTab = 'Dashboard'; render(); setTimeout(()=>{ document.getElementById('non-conformity-list')?.scrollIntoView({behavior:'smooth'}); },100); }
      else if (card.kpi === 'Alertas Ativos') { state.showModal = 'alerts'; render(); }
    };
    el.innerHTML = `<div><p class="text-sm font-medium text-gray-500">${card.title}</p><h2 class="text-3xl font-bold mt-1 ${card.color}">${card.count}</h2></div><div class="text-4xl opacity-20">${card.icon}</div>`;
    kpiGrid.appendChild(el);
  });
  container.appendChild(kpiGrid);

  // Chart area (doughnut)
  const chartWrap = document.createElement('div'); chartWrap.className = 'painel-grafico bg-white p-6 rounded-xl shadow-lg mt-6';
  const chartHeader = document.createElement('div'); chartHeader.className = 'flex items-center justify-between mb-4';
  chartHeader.innerHTML = `<h3 class="text-xl font-bold text-gray-800">Gr√°fico de Distribui√ß√£o</h3>`;
  const selector = document.createElement('div'); selector.className = 'flex items-center space-x-2';
  selector.innerHTML = `<label class="text-sm text-gray-600">Base:</label>`;
  const selectChart = document.createElement('select'); selectChart.className = 'p-2 border rounded-lg text-sm';
  selectChart.onchange = (e) => { state.chartSourceKey = e.target.value; render(); };
  state.config.allColumns.filter(c => c.isChartSource).forEach(col => {
    const opt = document.createElement('option'); opt.value = col.key; opt.text = col.label; if (state.chartSourceKey === col.key) opt.selected = true; selectChart.appendChild(opt);
  });
  selector.appendChild(selectChart);
  chartHeader.appendChild(selector);
  chartWrap.appendChild(chartHeader);

  // compute chart data
  const chartData = {};
  state.data.filter(ext => ext[state.chartSourceKey] && ext[state.chartSourceKey] !== '-').forEach(ext => {
    const key = String(ext[state.chartSourceKey]);
    chartData[key] = (chartData[key] || 0) + 1;
  });
  const total = Object.values(chartData).reduce((s,c)=>s+c,0);
  // create chart area
  const chartArea = document.createElement('div'); chartArea.className = 'flex flex-col md:flex-row items-start justify-center';
  if (total === 0) {
    chartArea.innerHTML = '<p class="text-center text-gray-500">Sem dados para o gr√°fico.</p>';
  } else {
    // convert to values
    let currentAngle = 0;
    const entries = Object.entries(chartData).map(([name,count], idx) => {
      const percent = (count / total) * 100;
      const color = `hsl(${(idx*45)%360} 70% 50%)`;
      const startAngle = currentAngle;
      const endAngle = currentAngle + percent*3.6;
      currentAngle = endAngle;
      return { name, value: count, percent: percent.toFixed(1), color, startAngle, endAngle };
    }).filter(i => i.value>0);
    // svg
    const svgWrap = document.createElement('div'); svgWrap.className = 'w-full md:w-1/2 p-4 flex justify-center';
    const svgSize = 200; const center = 70; const radius = 60;
    const svgNS = 'http://www.w3.org/2000/svg';
    const svg = document.createElementNS(svgNS,'svg');
    svg.setAttribute('width', svgSize); svg.setAttribute('height', svgSize); svg.setAttribute('viewBox', `0 0 ${center*2} ${center*2}`);
    
    entries.forEach(item => {
      const startRad = (item.startAngle-90) * Math.PI/180;
      const endRad = (item.endAngle-90) * Math.PI/180;
      
      const startX = center + radius * Math.cos(startRad);
      // CORRE√á√ÉO: Usar startRad para calcular o ponto Y de in√≠cio (o que define o raio inicial)
      const startY = center + radius * Math.sin(startRad); 
      
      const endX = center + radius * Math.cos(endRad);
      const endY = center + radius * Math.sin(endRad);
      
      const largeArc = (item.percent > 50) ? 1 : 0;
      const path = document.createElementNS(svgNS,'path');
      path.setAttribute('d', `M ${center},${center} L ${startX},${startY} A ${radius},${radius} 0 ${largeArc},1 ${endX},${endY} Z`);
      path.setAttribute('fill', item.color);
      svg.appendChild(path);
    });
    const hole = document.createElementNS(svgNS,'circle'); hole.setAttribute('cx', center); hole.setAttribute('cy', center); hole.setAttribute('r', radius*0.6); hole.classList.add('shadow-inner');
    hole.setAttribute('fill','white'); 
    svg.appendChild(hole);
    const text1 = document.createElementNS(svgNS,'text'); text1.setAttribute('x', center); text1.setAttribute('y', center-5); text1.setAttribute('text-anchor','middle'); text1.setAttribute('alignment-baseline','central'); text1.setAttribute('font-size','18'); text1.setAttribute('fill','#333'); text1.setAttribute('class','font-bold'); text1.textContent = total;
    svg.appendChild(text1);
    const text2 = document.createElementNS(svgNS,'text'); text2.setAttribute('x', center); text2.setAttribute('y', center+15); text2.setAttribute('text-anchor','middle'); text2.setAttribute('alignment-baseline','central'); text2.setAttribute('font-size','10'); text2.setAttribute('fill','#666'); text2.setAttribute('class','font-semibold'); text2.textContent = 'Total';
    svg.appendChild(text2);

    svgWrap.appendChild(svg);
    chartArea.appendChild(svgWrap);

    // legend
    const legend = document.createElement('div'); legend.className = 'w-full md:w-1/2 p-4';
    legend.innerHTML = `<h5 class="font-semibold text-gray-700 mb-3">Legenda (${state.config.allColumns.find(c=>c.key===state.chartSourceKey)?.label || state.chartSourceKey})</h5>`;
    const ul = document.createElement('ul'); ul.className = 'space-y-2 max-h-48';
    entries.forEach(item => {
      const li = document.createElement('li'); li.className = 'flex justify-between items-center text-sm cursor-pointer hover:bg-gray-100 p-1 rounded transition';
      li.innerHTML = `<div class="flex items-center"><span class="w-3 h-3 rounded-full mr-2 shadow" style="background:${item.color}"></span>${item.name}</div><span class="font-semibold">${item.percent}% (${item.value})</span>`;
      ul.appendChild(li);
    });
    legend.appendChild(ul);
    chartArea.appendChild(legend);
  }

  chartWrap.appendChild(chartArea);
  container.appendChild(chartWrap);

  // Non-conformities list
  const nonConfWrap = document.createElement('div'); nonConfWrap.id = 'non-conformity-list'; nonConfWrap.className = 'bg-white p-6 rounded-xl shadow-lg mt-6';
  nonConfWrap.innerHTML = `<h3 class="text-xl font-bold text-red-600 mb-4 flex items-center">‚ùå Extintores N√£o Conformes (${nonConformingList.length})</h3>`;
  const listWrap = document.createElement('div'); listWrap.className = 'space-y-3';
  if (nonConformingList.length === 0) {
    listWrap.innerHTML = '<p class="text-gray-500">Nenhuma n√£o conformidade ativa.</p>';
  } else {
    nonConformingList.forEach(item => {
      const card = document.createElement('div');
      card.className = 'p-4 border border-red-200 rounded-lg cursor-pointer hover:bg-red-50 transition';
      card.onclick = () => { state.selectedExtinguisher = state.data.find(e=>e.id===item.id); state.showModal = 'panel'; render(); };
      card.innerHTML = `<p class="font-bold text-lg text-red-800">N¬∫ ${item.num}</p>
        <p class="text-sm mt-1"><span class="font-semibold">Situa√ß√£o:</span> <span class="text-red-600">${item.situacao}</span></p>
        <p class="text-sm"><span class="font-semibold">N√£o conformidade:</span> ${item.naoConformidade || '-'}</p>
        <p class="text-xs text-gray-600 mt-1"><span class="font-semibold">Observa√ß√£o:</span> ${item.observacao || '-'}</p>`;
      listWrap.appendChild(card);
    });
  }
  nonConfWrap.appendChild(listWrap);
  container.appendChild(nonConfWrap);
}

/* ---------- Render Visualiza√ß√£o (pain√©is) ---------- */
function renderVisualizacaoSection(container) {
  // Renderiza o filtro. O estado de visibilidade √© controlado por state.showFilter
  const filterBar = createFilterBar(); 
  container.appendChild(filterBar);

  const grid = document.createElement('div'); grid.className = 'grid grid-cols-1 md:grid-cols-2 gap-4 mt-4';
  const { filteredData } = computeFiltered();
  const allColumns = state.config.allColumns;
  if (filteredData.length === 0) {
    const p = document.createElement('p'); p.className = 'text-gray-500 col-span-full text-center py-10'; p.textContent = 'Nenhum extintor encontrado com o filtro atual.';
    grid.appendChild(p);
  } else {
    filteredData.forEach(ext => {
      const wrapper = document.createElement('div'); wrapper.className = 'cursor-pointer hover:shadow-xl transition-shadow duration-300';
      wrapper.onclick = () => { state.selectedExtinguisher = ext; state.showModal = 'panel'; render(); };
      wrapper.appendChild(renderExtinguisherPanel(ext, allColumns));
      grid.appendChild(wrapper);
    });
  }
  container.appendChild(grid);
}

/* ---------- Extinguisher Panel (card) ---------- */
function renderExtinguisherPanel(extinguisher, allColumns) {
  const root = document.createElement('div'); root.className = 'relative bg-white rounded-xl shadow-lg overflow-hidden';
  
  const header = document.createElement('div'); header.className = 'flex items-center justify-between p-2 bg-red-600 text-white';
  header.innerHTML = `<h4 class="text-base font-extrabold flex items-center">üßØ Extintor N¬∫ ${extinguisher['N¬∫']}</h4><span class="text-xs font-semibold bg-white text-red-600 px-2 py-0.5 rounded-full">${extinguisher['Local'] || '-'}</span>`;
  root.appendChild(header);

  const content = document.createElement('div'); content.className = 'p-2';
  PANEL_BLOCKS_STRUCTURE.forEach(block => {
    const hasVisible = block.fields.some(k => allColumns.find(c=>c.key===k && c.visible));
    if (!hasVisible) return;
    
    const blockDiv = document.createElement('div'); blockDiv.className = 'mb-2 last:mb-0 border rounded-lg p-1.5 bg-gray-50';
    blockDiv.innerHTML = `<p class="text-xs font-bold text-gray-600 border-b pb-0.5 mb-1">${block.name}</p>`;
    
    const grid = document.createElement('div'); grid.className = 'grid grid-cols-2 gap-x-3';
    block.fields.forEach(key => {
      const colConfig = allColumns.find(c=>c.key===key);
      if (!colConfig || !colConfig.visible) return;
      const value = extinguisher[key] || '-';
      let colorClass = 'text-gray-800', bgClass = 'bg-white', statusText = '', isBig=false;
      if (key==='N¬∫') isBig=true;
      if (key==='SITUA√á√ÉO') { const s = getStatusColor(value); colorClass = s.color; bgClass = s.bgColor; isBig=true; }
      else if (key==='2¬∫ N√≠vel' || key==='3¬∫ N√≠vel') { const s = getDateStatus(key, value); colorClass = s.color; statusText = s.status; }
      
      const fontClass = isBig ? 'text-base font-extrabold' : 'text-xs font-medium';
      
      const cell = document.createElement('div'); cell.className = `p-1 ${isBig?'col-span-2':'col-span-1'} border-b border-gray-100 ${bgClass}`;
      cell.innerHTML = `<p class="text-xs text-gray-500 mb-0">${colConfig.label || key}</p><div class="flex items-center space-x-1"><span class="${fontClass} ${colorClass}">${value}</span>${statusText?` <span class="text-xs ml-1 px-1 py-0.5 rounded-full bg-white text-gray-600 border border-gray-300">${statusText}</span>`:''}</div>`;
      grid.appendChild(cell);
    });
    blockDiv.appendChild(grid);
    content.appendChild(blockDiv);
  });
  root.appendChild(content);
  return root;
}

/* ---------- Render Tabela ---------- */
function renderTabelaSection(container) {
  // Renderiza o filtro. O estado de visibilidade √© controlado por state.showFilter
  const filterBar = createFilterBar();
  container.appendChild(filterBar);

  const tableWrap = document.createElement('div'); tableWrap.className = 'overflow-x-auto bg-white rounded-xl shadow-lg mt-6';
  const table = document.createElement('table'); table.className = 'min-w-full divide-y divide-gray-200';
  const thead = document.createElement('thead'); thead.className = 'bg-gray-50 sticky top-0 z-10 shadow-md';
  const trh = document.createElement('tr');
  const visibleCols = state.config.allColumns.filter(c=>c.visible);
  visibleCols.forEach(col => {
    const isObs = col.key === 'Observa√ß√£o';
    const widthClasses = isObs ? 'min-w-200' : 'w-fit-content';
    const th = document.createElement('th'); th.className = `px-3 ${state.config.tableStyle.rowHeight} text-left text-xs font-medium text-gray-500 uppercase tracking-wider whitespace-nowrap ${widthClasses}`; th.textContent = col.label; trh.appendChild(th);
  });
  thead.appendChild(trh);
  table.appendChild(thead);

  const tbody = document.createElement('tbody'); tbody.className = 'divide-y divide-gray-200';
  const { filteredData } = computeFiltered();
  if (filteredData.length === 0) {
    const tr = document.createElement('tr'); const td = document.createElement('td'); td.colSpan = visibleCols.length; td.className = 'text-center py-10 text-gray-500'; td.textContent = 'Nenhum extintor encontrado.'; tr.appendChild(td); tbody.appendChild(tr);
  } else {
    filteredData.forEach(ext => {
      const tr = document.createElement('tr'); tr.className = 'hover:bg-gray-50 transition duration-150';
      visibleCols.forEach(col => {
        const value = ext[col.key] || '-';
        let bgColorClass = '';
        let statusText = '';
        if (col.key === 'SITUA√á√ÉO') { bgColorClass = getStatusColor(value).bgColor; }
        else if (col.key === '2¬∫ N√≠vel' || col.key === '3¬∫ N√≠vel') { const ds = getDateStatus(col.key, value); bgColorClass = ds.bgColor; statusText = ds.status; }

        const isObs = col.key === 'Observa√ß√£o';
        const whitespaceClass = isObs ? 'whitespace-normal' : 'whitespace-nowrap';
        const widthClasses = isObs ? 'min-w-200' : 'w-fit-content'; 

        const td = document.createElement('td'); 
        td.className = `px-3 ${state.config.tableStyle.rowHeight} ${state.config.tableStyle.fontSize} border border-gray-200 bg-white align-top ${bgColorClass} ${whitespaceClass} ${widthClasses}`;
        
        td.innerHTML = `<div class="${col.isId ? 'font-bold text-red-700' : 'text-gray-800'}">${value}${statusText?` <span class="text-xs ml-2 px-1 py-0.5 rounded-full bg-white text-gray-600 border border-gray-300">${statusText}</span>`:''}</div>`;
        tr.appendChild(td);
      });
      tbody.appendChild(tr);
    });
  }
  table.appendChild(tbody);
  tableWrap.appendChild(table);
  container.appendChild(tableWrap);
}

/* ---------- Render Se√ß√£o de Inspe√ß√µes (Formul√°rio) ---------- */
function renderInspecoesSection(container) {
  const wrap = document.createElement('div'); 
  wrap.className = 'div-inspecoes max-w-6xl mx-auto space-y-6 bg-white p-6 rounded-xl shadow-lg border-t-4 border-red-500';
  
  if (!state.isLoggedIn) {
      wrap.innerHTML = `
          <div class="text-center py-10">
              <h3 class="text-2xl font-bold text-red-600 mb-2">Acesso Negado üîí</h3>
              <p class="text-gray-600 mb-6">Voc√™ precisa estar logado como vistoriador para registrar uma nova inspe√ß√£o.</p>
              <button onclick="(() => { state.activeTab = 'User'; render(); })()" 
                      class="py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-red-600 hover:bg-red-700 transition">
                  Ir para Login
              </button>
          </div>
      `;
  } else {
      // Codifica o nome de usu√°rio para usar em um URL
      const encodedUsername = encodeURIComponent(state.username || '');
      
      // URL base do formul√°rio de inspe√ß√£o. ATUALIZADO conforme a solicita√ß√£o do usu√°rio.
      const baseIframeUrl = 'https://sescincjoi.github.io/Central-SCI-JOI/extintoresinspecao.html'; 
      // Usando '?' para adicionar o primeiro par√¢metro de consulta ao URL.
      const iframeUrl = `${baseIframeUrl}?nomeUsuario=${encodedUsername}`;
      
      wrap.innerHTML = `
          <h3 class="text-2xl font-bold text-red-700 mb-4 flex items-center">
            üìù Formul√°rio de Inspe√ß√£o Online 
            <span class="text-base text-gray-500 font-normal ml-3">Vistoriador: ${state.username}</span>
          </h3>
          
          <div class="info-nomeUsuario p-4 border border-blue-200 rounded-lg bg-blue-50 text-blue-800 mb-6">
            <p class="font-semibold">Instru√ß√£o:</p>
            <p class="text-sm">O campo de nome de usu√°rio/vistoriador no formul√°rio abaixo foi pr√©-preenchido com: <span class="font-bold text-blue-900">${state.username}</span>. O formul√°rio deve ler o par√¢metro <code class="font-mono text-xs px-1 bg-blue-100 rounded">nomeUsuario</code> do URL.</p>
          </div>
          
          <!-- Iframe Container para Responsividade -->
          <div class="relative w-full" style="height: 80vh;">
            <iframe 
              src="${iframeUrl}" 
              frameborder="0" 
              class="w-full h-full rounded-lg shadow-inner border border-gray-300"
              title="Formul√°rio de Registro de Inspe√ß√£o">
            </iframe>
          </div>
      `;
  }
  
  container.appendChild(wrap);
}

/* ---------- Render Configura√ß√µes ---------- */
function renderConfiguracoesSection(container) {
  const wrap = document.createElement('div'); wrap.className = 'space-y-8 bg-white p-6 rounded-xl shadow-lg';
  wrap.innerHTML = `<h3 class="text-2xl font-bold text-red-600 border-b pb-3 mb-4">‚öôÔ∏è Configura√ß√µes do Sistema</h3>`;
  // Fonte + sync
  const section = document.createElement('section');
  const sectionHtml = `
    <h4 class="text-xl font-semibold text-gray-800 mb-2">Fonte de Dados e Sincroniza√ß√£o</h4>
    <div class="p-4 border rounded-lg bg-gray-50 space-y-4">
      <div class="space-y-2">
        <label class="block text-sm font-medium text-gray-700">Alcance de Dados (Ex: A:P, A1:H50)</label>
        <div class="flex space-x-2">
          <input id="data-range-input" type="text" class="flex-grow p-2 border border-gray-300 rounded-lg focus:ring-red-500 focus:border-red-500" value="${state.config.dataRange}" />
          <button id="refresh-btn" class="flex items-center bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">
            üîÑ Atualizar Dados Manualmente
          </button>
        </div>
      </div>
      <div class="pt-4 border-t border-gray-200 space-y-2">
        <label class="block text-sm font-medium text-gray-700 mb-1">Intervalo de Sincroniza√ß√£o Autom√°tica (segundos)</label>
        <input id="sync-interval-input" type="number" min="5" placeholder="M√≠nimo 5 segundos" class="w-full md:w-40 p-2 border border-gray-300 rounded-lg focus:ring-red-500 focus:border-red-500" value="${state.syncIntervalMs===0?'':(state.syncIntervalMs/1000)}" />
        <p class="text-xs text-gray-600 mt-1">Defina 5 segundos ou mais. Deixe o campo vazio para desativar a sincroniza√ß√£o.</p>
      </div>
      <div class="text-sm text-gray-600 pt-3 mt-3 border-t border-gray-200">
        <p class="flex items-center">üîÅ Sincroniza√ß√£o Autom√°tica: <span id="sync-status" class="font-semibold ml-1 ${state.syncIntervalMs>0?'text-green-700':'text-red-700'}">${state.syncIntervalMs>0?`Ativa (${state.syncIntervalMs/1000}s)`:'Desativada'}</span></p>
        <p class="mt-1">√öltima atualiza√ß√£o: <span id="last-sync-time" class="font-semibold text-gray-700 ml-1">${state.lastSyncTime || 'N/A'}</span></p>
      </div>
    </div>
  `;
  section.innerHTML = sectionHtml;
  wrap.appendChild(section);

  // Colunas vis√≠veis
  const colsSection = document.createElement('section');
  colsSection.innerHTML = `<h4 class="text-xl font-semibold text-gray-800 mb-2">Colunas Vis√≠veis (Todo o Sistema)</h4>`;
  const grid = document.createElement('div'); grid.className = 'grid grid-cols-2 md:grid-cols-3 gap-3 p-4 border rounded-lg bg-gray-50';
  state.config.allColumns.forEach(col => {
    const item = document.createElement('div'); item.className = 'flex items-center';
    const input = document.createElement('input'); input.type = 'checkbox'; input.checked = col.visible; input.disabled = !!col.isFixed; input.className = 'w-4 h-4 text-red-600 border-gray-300 rounded focus:ring-red-500';
    input.onchange = () => { col.visible = !col.visible; render(); };
    const label = document.createElement('label'); label.className = `ml-2 text-sm font-medium ${col.isFixed ? 'text-gray-400' : 'text-gray-700'}`; label.textContent = `${col.label} (${col.key})`;
    item.appendChild(input); item.appendChild(label); grid.appendChild(item);
  });
  colsSection.appendChild(grid);
  wrap.appendChild(colsSection);

  container.appendChild(wrap);

  // --- HANDLERS LOCAIS ---
  const refreshBtn = section.querySelector('#refresh-btn');
  const dataRangeInput = section.querySelector('#data-range-input');
  const syncIntervalInput = section.querySelector('#sync-interval-input');

  if (refreshBtn && dataRangeInput) {
    refreshBtn.onclick = async () => {
      const range = dataRangeInput.value.toUpperCase();
      state.config.dataRange = range || DEFAULT_RANGE;
      await manualLoadData();
    };
  }

  if (syncIntervalInput) {
    syncIntervalInput.onchange = (e) => {
      const sec = parseInt(e.target.value, 10);
      if (!isNaN(sec) && sec >= 5) { state.syncIntervalMs = sec * 1000; startAutoSync(); }
      else if (e.target.value === '') { state.syncIntervalMs = 0; startAutoSync(); }
      render(); // atualizar status display
    };
  }
}

/* ---------- Render Se√ß√£o de Usu√°rio (Login/Perfil) ---------- */
function renderUserSection(container) {
  const wrap = document.createElement('div'); wrap.className = 'max-w-xl mx-auto space-y-6 bg-white p-6 rounded-xl shadow-lg border-t-4 border-red-500';

  if (state.isLoggedIn) {
    // --- Perfil do Usu√°rio Logado ---
    wrap.innerHTML = `
      <h3 class="text-2xl font-bold text-red-700 flex items-center">
        Bem-vindo, ${state.username}! üëã
      </h3>
      <p class="text-gray-600">Voc√™ est√° logado como vistoriador. Seu nome ser√° associado aos dados de inspe√ß√£o enviados para a planilha.</p>
      <div class="p-4 border border-red-200 rounded-lg bg-red-50 space-y-2">
        <p class="text-sm font-semibold text-red-800">Seu Identificador de Vistoria:</p>
        <p class="text-xl font-mono">${state.username}</p>
      </div>
      <button id="logout-btn" class="w-full py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gray-500 hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-400 transition duration-150">
        Sair / Trocar Vistoriador
      </button>
    `;
    wrap.querySelector('#logout-btn').onclick = handleLogout;
    
  } else {
    // --- Formul√°rio de Login ---
    wrap.innerHTML = `
      <h3 class="text-2xl font-bold text-red-700 flex items-center">
        Login do Vistoriador üë§
      </h3>
      <p class="text-sm text-gray-600">Por favor, insira seu nome e a senha √∫nica para iniciar a sess√£o e registrar o vistoriador.</p>
      
      <form id="login-form" class="space-y-4">
        <div>
          <label for="username" class="block text-sm font-medium text-gray-700">Seu Nome / Identificador</label>
          <input type="text" id="username" name="username" required autocomplete="username"
                 class="mt-1 block w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500" 
                 placeholder="Ex: Jo√£o Silva" 
                 value="${localStorage.getItem(LS_USERNAME_KEY) || ''}">
        </div>

        <div>
          <label for="password" class="block text-sm font-medium text-gray-700">Senha √önica (Extintor)</label>
          <input type="password" id="password" name="password" required autocomplete="current-password"
                 class="mt-1 block w-full p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-red-500 focus:border-red-500" 
                 placeholder="Digite a senha fixa"
                 value="${localStorage.getItem(LS_PASSWORD_KEY) || ''}">
        </div>

        <div id="login-error-message" class="hidden p-3 bg-red-100 text-red-800 rounded-md text-sm font-medium"></div>

        <button type="submit" id="login-btn"
                class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-base font-medium text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition duration-150">
          Entrar e Salvar Nome
        </button>
        <p class="text-xs text-gray-500 text-center">A senha ser√° salva no seu navegador para preenchimento autom√°tico.</p>
      </form>
    `;
    wrap.querySelector('#login-form').onsubmit = handleLogin;
    
  }
  container.appendChild(wrap);
}


/* ---------- Modal rendering ---------- */
function closeModal() { state.showModal = null; state.selectedExtinguisher = null; render(); }
function renderModal() {
  const root = $('#modal-root');
  if (!root) return;
  root.innerHTML = '';
  if (!state.showModal) return;
  const overlay = document.createElement('div'); overlay.className = 'fixed inset-0 z-50 overflow-y-auto bg-gray-900 bg-opacity-75 flex items-center justify-center p-4';
  overlay.onclick = closeModal;
  const sizeClasses = { sm: 'max-w-sm', md: 'max-w-lg', lg: 'max-w-2xl', xl: 'max-w-4xl' };
  const modal = document.createElement('div'); modal.className = `bg-white rounded-xl shadow-2xl p-6 transform transition-all w-full ${sizeClasses['lg']}`;
  modal.onclick = (e) => e.stopPropagation();
  const header = document.createElement('div'); header.className = 'flex justify-between items-center border-b pb-3 mb-4';
  const title = document.createElement('h3'); title.className = 'text-xl font-bold text-gray-800';
  const closeBtn = document.createElement('button'); closeBtn.className = 'text-gray-400 hover:text-gray-600'; closeBtn.textContent = '‚úñ'; closeBtn.onclick = closeModal;
  header.appendChild(title); header.appendChild(closeBtn);
  modal.appendChild(header);

  if (state.showModal === 'conforming') {
    const conforming = state.data.filter(ext => getExtinguisherStatus(ext).isConforme);
    title.textContent = `Extintores Conformes (${conforming.length})`;
    const p = document.createElement('p'); p.className='mb-3 text-gray-600'; p.textContent = "Lista de N¬∫ de extintores que est√£o com status 'Conforme'.";
    modal.appendChild(p);
    const grid = document.createElement('div'); grid.className = 'grid grid-cols-5 gap-3 max-h-80 overflow-y-auto p-2 border rounded-lg bg-green-50';
    conforming.forEach(ext => {
      const d = document.createElement('div'); d.className = 'p-2 bg-green-200 text-green-800 text-center text-sm font-bold rounded-lg shadow-sm cursor-pointer hover:bg-green-300 transition';
      d.textContent = ext['N¬∫']; d.onclick = ()=>{ state.selectedExtinguisher = ext; state.showModal = 'panel'; render(); };
      grid.appendChild(d);
    });
    modal.appendChild(grid);
  } else if (state.showModal === 'alerts') {
    const alerts = computeFiltered().activeAlertsList;
    title.textContent = `Alertas Ativos (${alerts.length})`;
    const p = document.createElement('p'); p.className='mb-3 text-gray-600'; p.textContent = "Extintores com datas de inspe√ß√£o pr√≥ximas ao vencimento ou vencidas, ou com situa√ß√£o indefinida.";
    modal.appendChild(p);
    const wrap = document.createElement('div'); wrap.className = 'space-y-3 max-h-96 overflow-y-auto p-3 border rounded-lg bg-yellow-50';
    if (alerts.length === 0) wrap.innerHTML = '<p class="text-gray-500">Nenhum alerta ativo no momento.</p>';
    else {
      alerts.forEach(item => {
        const card = document.createElement('div'); card.className = 'p-4 border border-yellow-300 rounded-lg cursor-pointer hover:bg-yellow-100 transition';
        card.onclick = ()=>{ state.selectedExtinguisher = state.data.find(e=>e.id===item.id); state.showModal='panel'; render(); };
        card.innerHTML = `<p class="font-bold text-lg text-yellow-800 flex justify-between items-center">N¬∫ ${item.num} - ${item.local} <span>‚ö†Ô∏è</span></p>`;
        const ul = document.createElement('ul'); ul.className='list-disc list-inside text-sm mt-1 text-gray-700';
        item.details.forEach(d=>{ const li=document.createElement('li'); li.textContent=d; ul.appendChild(li); });
        card.appendChild(ul);
        wrap.appendChild(card);
      });
    }
    modal.appendChild(wrap);
  } else if (state.showModal === 'panel' && state.selectedExtinguisher) {
    title.textContent = `Detalhes do Extintor N¬∫ ${state.selectedExtinguisher['N¬∫']}`;
    const panel = renderExtinguisherPanel(state.selectedExtinguisher, state.config.allColumns);
    modal.appendChild(panel);
  }

  overlay.appendChild(modal);
  root.appendChild(overlay);
}

/* ---------- Render principal ---------- */
function renderMainContent() {
  const main = $('#main-content'); 
  if (!main) return; 
  main.innerHTML = '';
  if (state.loading) {
    const tpl = document.getElementById('loading-template'); 
    if (tpl) main.appendChild(tpl.content.cloneNode(true));
    return;
  }
  if (state.activeTab === 'Dashboard') {
    // FECHA O FILTRO AO SAIR DA ABA
    state.showFilter = false;
    const container = document.createElement('div'); container.className = 'space-y-8';
    renderDashboardSection(container);
    main.appendChild(container);
  } else if (state.activeTab === 'Visualiza√ß√£o') {
    const container = document.createElement('div'); container.className = 'space-y-6';
    renderVisualizacaoSection(container);
    main.appendChild(container);
  } else if (state.activeTab === 'Tabela') {
    const container = document.createElement('div'); container.className = 'space-y-6';
    renderTabelaSection(container);
    main.appendChild(container);
  } else if (state.activeTab === 'Inspecoes') { 
    // FECHA O FILTRO AO SAIR DA ABA
    state.showFilter = false;
    const container = document.createElement('div');
    renderInspecoesSection(container);
    main.appendChild(container);
  } else if (state.activeTab === 'Configura√ß√µes') {
    // FECHA O FILTRO AO SAIR DA ABA
    state.showFilter = false;
    const container = document.createElement('div');
    renderConfiguracoesSection(container);
    main.appendChild(container);
  } else if (state.activeTab === 'User') { 
    // FECHA O FILTRO AO SAIR DA ABA
    state.showFilter = false;
    const container = document.createElement('div');
    renderUserSection(container);
    main.appendChild(container);
  }
}

/* ---------- Data loading (manual + auto sync) ---------- */
async function manualLoadData() {
  state.loading = true; render();
  const url = GOOGLE_SHEET_BASE_URL + (state.config.dataRange || DEFAULT_RANGE);
  const dt = await fetchData(url);
  state.data = dt;
  state.loading = false;
  state.lastSyncTime = new Date().toLocaleTimeString();
  render();
}
let autoSyncTimer = null;
function startAutoSync() {
  if (autoSyncTimer) { clearInterval(autoSyncTimer); autoSyncTimer = null; }
  if (state.syncIntervalMs > 0) {
    autoSyncTimer = setInterval(() => { manualLoadData(); }, state.syncIntervalMs);
  }
}

/* ---------- Inicializa√ß√£o ---------- */
async function init() {
  checkAuthOnLoad(); 

  // --- NOVO: L√ìGICA CLICK-OUTSIDE PARA FILTRO ---
  document.addEventListener('click', (event) => {
    // S√≥ age se o filtro estiver aberto
    if (state.showFilter) {
      const filterWrapper = document.getElementById('filter-wrapper');
      // Verifica se o clique ocorreu fora do container do filtro (bot√£o + menu)
      if (filterWrapper && !filterWrapper.contains(event.target)) {
        state.showFilter = false;
        render(); // Renderiza para fechar o filtro
      }
    }
  });
  // ---------------------------------------------
  
  await manualLoadData();
  startAutoSync();
  
  // set up periodic render (to update timers/status colors)
  setInterval(()=>{ render(); }, 1000*60); 
}

// Inicia a aplica√ß√£o ap√≥s a defini√ß√£o de todas as fun√ß√µes
init();

/* cleanup on unload */
window.addEventListener('beforeunload', () => { if (autoSyncTimer) clearInterval(autoSyncTimer); });

</script>
</body>
</html>
